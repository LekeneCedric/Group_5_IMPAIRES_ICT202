{"version":3,"sources":["../../../../../modules/@angular/core/src/animation/animation_style_util.ts"],"names":[],"mappings":"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","file":"animation_style_util.js","sourceRoot":"","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {StringMapWrapper} from '../facade/collection';\nimport {isPresent} from '../facade/lang';\n\nimport {FILL_STYLE_FLAG} from './animation_constants';\nimport {AUTO_STYLE} from './metadata';\n/**\n * @param {?} previousStyles\n * @param {?} newStyles\n * @param {?=} nullValue\n * @return {?}\n */\nexport function prepareFinalAnimationStyles(\n    previousStyles: {[key: string]: string | number}, newStyles: {[key: string]: string | number},\n    nullValue: string = null): {[key: string]: string} {\n  const /** @type {?} */ finalStyles: {[key: string]: string} = {};\n\n  Object.keys(newStyles).forEach(prop => {\n    const /** @type {?} */ value = newStyles[prop];\n    finalStyles[prop] = value == AUTO_STYLE ? nullValue : value.toString();\n  });\n\n  Object.keys(previousStyles).forEach(prop => {\n    if (!isPresent(finalStyles[prop])) {\n      finalStyles[prop] = nullValue;\n    }\n  });\n\n  return finalStyles;\n}\n/**\n * @param {?} collectedStyles\n * @param {?} finalStateStyles\n * @param {?} keyframes\n * @return {?}\n */\nexport function balanceAnimationKeyframes(\n    collectedStyles: {[key: string]: string | number},\n    finalStateStyles: {[key: string]: string | number}, keyframes: any[]): any[] {\n  const /** @type {?} */ limit = keyframes.length - 1;\n  const /** @type {?} */ firstKeyframe = keyframes[0];\n\n  // phase 1: copy all the styles from the first keyframe into the lookup map\n  const /** @type {?} */ flatenedFirstKeyframeStyles = flattenStyles(firstKeyframe.styles.styles);\n\n  const /** @type {?} */ extraFirstKeyframeStyles: {[key: string]: string} = {};\n  let /** @type {?} */ hasExtraFirstStyles = false;\n  Object.keys(collectedStyles).forEach(prop => {\n    const /** @type {?} */ value = /** @type {?} */(( collectedStyles[prop] as string));\n    // if the style is already defined in the first keyframe then\n    // we do not replace it.\n    if (!flatenedFirstKeyframeStyles[prop]) {\n      flatenedFirstKeyframeStyles[prop] = value;\n      extraFirstKeyframeStyles[prop] = value;\n      hasExtraFirstStyles = true;\n    }\n  });\n\n  const /** @type {?} */ keyframeCollectedStyles = StringMapWrapper.merge({}, flatenedFirstKeyframeStyles);\n\n  // phase 2: normalize the final keyframe\n  const /** @type {?} */ finalKeyframe = keyframes[limit];\n  finalKeyframe.styles.styles.unshift(finalStateStyles);\n\n  const /** @type {?} */ flatenedFinalKeyframeStyles = flattenStyles(finalKeyframe.styles.styles);\n  const /** @type {?} */ extraFinalKeyframeStyles: {[key: string]: string} = {};\n  let /** @type {?} */ hasExtraFinalStyles = false;\n  Object.keys(keyframeCollectedStyles).forEach(prop => {\n    if (!isPresent(flatenedFinalKeyframeStyles[prop])) {\n      extraFinalKeyframeStyles[prop] = AUTO_STYLE;\n      hasExtraFinalStyles = true;\n    }\n  });\n\n  if (hasExtraFinalStyles) {\n    finalKeyframe.styles.styles.push(extraFinalKeyframeStyles);\n  }\n\n  Object.keys(flatenedFinalKeyframeStyles).forEach(prop => {\n    if (!isPresent(flatenedFirstKeyframeStyles[prop])) {\n      extraFirstKeyframeStyles[prop] = AUTO_STYLE;\n      hasExtraFirstStyles = true;\n    }\n  });\n\n  if (hasExtraFirstStyles) {\n    firstKeyframe.styles.styles.push(extraFirstKeyframeStyles);\n  }\n\n  collectAndResolveStyles(collectedStyles, [finalStateStyles]);\n\n  return keyframes;\n}\n/**\n * @param {?} styles\n * @return {?}\n */\nexport function clearStyles(styles: {[key: string]: string | number}): {[key: string]: string} {\n  const /** @type {?} */ finalStyles: {[key: string]: string} = {};\n  Object.keys(styles).forEach(key => { finalStyles[key] = null; });\n  return finalStyles;\n}\n/**\n * @param {?} collection\n * @param {?} styles\n * @return {?}\n */\nexport function collectAndResolveStyles(\n    collection: {[key: string]: string | number}, styles: {[key: string]: string | number}[]) {\n  return styles.map(entry => {\n    const /** @type {?} */ stylesObj: {[key: string]: string | number} = {};\n    Object.keys(entry).forEach(prop => {\n      let /** @type {?} */ value = entry[prop];\n      if (value == FILL_STYLE_FLAG) {\n        value = collection[prop];\n        if (!isPresent(value)) {\n          value = AUTO_STYLE;\n        }\n      }\n      collection[prop] = value;\n      stylesObj[prop] = value;\n    });\n    return stylesObj;\n  });\n}\n/**\n * @param {?} element\n * @param {?} renderer\n * @param {?} styles\n * @return {?}\n */\nexport function renderStyles(\n    element: any, renderer: any, styles: {[key: string]: string | number}): void {\n  Object.keys(styles).forEach(prop => { renderer.setElementStyle(element, prop, styles[prop]); });\n}\n/**\n * @param {?} styles\n * @return {?}\n */\nexport function flattenStyles(styles: {[key: string]: string | number}[]): {[key: string]: string} {\n  const /** @type {?} */ finalStyles: {[key: string]: string} = {};\n  styles.forEach(entry => {\n    Object.keys(entry).forEach(prop => { finalStyles[prop] = /** @type {?} */(( entry[prop] as string)); });\n  });\n  return finalStyles;\n}\n"]}